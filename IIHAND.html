<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Uni.Circle | MARKETPLACE</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Space+Mono&display=swap" rel="stylesheet">
<script src="https://unpkg.com/lucide@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<style>
    :root { 
        --bg-black: #000000; 
        --accent-green: #00ff41; 
        --premium-purple: #a855f7; 
        --glass: rgba(255, 255, 255, 0.03); 
        --border: rgba(255, 255, 255, 0.1); 
        --pixel-font: 'Press Start 2P', cursive; 
        --mono-font: 'Space Mono', monospace; 
    }
    * { margin: 0; padding: 0; box-sizing: border-box; cursor: none; }
    body { background: var(--bg-black); color: white; font-family: var(--mono-font); overflow-x: hidden; }
    
    #custom-cursor { position: fixed; width: 20px; height: 20px; border: 1.5px solid white; border-radius: 50%; pointer-events: none; z-index: 9999; transform: translate(-50%, -50%); display: flex; align-items: center; justify-content: center; }
    #custom-cursor::after { content: ''; width: 3px; height: 3px; background: white; border-radius: 50%; }
    #bg-canvas { position: fixed; top: 0; left: 0; z-index: -1; }
    
    .container { max-width: 1300px; margin: 0 auto; padding: 0 40px; }
    
    .header-boundary { margin-top: 30px; padding: 20px 40px; background: rgba(255, 255, 255, 0.02); border: 1px solid var(--border); border-radius: 20px; backdrop-filter: blur(12px); display: flex; justify-content: space-between; align-items: center; margin-bottom: 50px; }
    .brand { font-family: var(--pixel-font); font-size: 0.65rem; color: #fff; text-decoration: none; letter-spacing: 2px; }
    
    .nav-buttons { display: flex; gap: 20px; }
    .nav-btn { padding: 10px 20px; border: 1px solid var(--border); border-radius: 10px; font-family: var(--pixel-font); font-size: 0.5rem; text-decoration: none; color: white; transition: 0.3s; }
    .nav-btn:hover { background: white; color: black; }

    .market-layout { display: grid; grid-template-columns: 280px 1fr; gap: 40px; margin-bottom: 100px; }
    
    .sidebar { background: var(--glass); border: 1px solid var(--border); border-radius: 20px; padding: 30px; height: fit-content; }
    .side-title { font-family: var(--pixel-font); font-size: 0.55rem; color: var(--accent-green); margin-bottom: 25px; }
    .cat-item { display: block; color: #666; text-decoration: none; font-family: var(--pixel-font); font-size: 0.45rem; margin-bottom: 20px; transition: 0.3s; }
    .cat-item:hover { color: white; transform: translateX(5px); }

    .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; }
    .glass-card { background: rgba(255,255,255,0.01); border: 1px solid var(--border); border-radius: 18px; padding: 30px; transition: 0.4s; }
    .glass-card:hover { border-color: var(--premium-purple); transform: translateY(-5px); background: rgba(168, 85, 247, 0.02); }

    .price { font-family: var(--pixel-font); color: var(--accent-green); font-size: 0.8rem; margin: 20px 0; }
    .node-btn { width: 100%; padding: 15px; background: transparent; border: 1px solid var(--border); color: #fff; font-family: var(--pixel-font); font-size: 0.45rem; border-radius: 5px; cursor: pointer; transition: 0.3s; }
    .node-btn:hover { border-color: white; color: var(--accent-green); box-shadow: 0 0 15px rgba(0, 255, 65, 0.2); }

    footer { padding: 60px 0; border-top: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
    .footer-text { font-family: var(--pixel-font); font-size: 0.45rem; color: #444; }
</style>
</head>
<body>

<div id="custom-cursor"></div>
<canvas id="bg-canvas"></canvas>

<div class="container">
    <div class="header-boundary">
        <a href="HOME.html" class="brand">UNI.CIRCLE | MARKETPLACE</a>
        <div class="nav-buttons">
            <a href="HOME.html" class="nav-btn" style="flex:1; min-width:120px; display:flex; align-items:center; justify-content:center;">HOME</a>
            <a href="ABOUT.html" class="nav-btn" style="flex:1; min-width:120px; display:flex; align-items:center; justify-content:center;">ABOUT US</a>
        </div>
    </div>

    <div class="market-layout">
        <aside class="sidebar">
            <p class="side-title">CATEGORIES</p>
            <a href="#" class="cat-item">NOTES</a>
            <a href="#" class="cat-item">ASSIGNMENTS</a>
            <a href="#" class="cat-item">PPTs</a>
            <p class="side-title" style="margin-top: 30px; color: var(--premium-purple);">MARKET</p>
            <a href="#" class="cat-item">BOOKS</a>
            <a href="#" class="cat-item">GADGETS</a>
            <a href="#" class="cat-item">HOSTEL ESSENTIALS</a>
            <p class="side-title" style="margin-top: 30px; color: var(--premium-purple);">COMMUNITY</p>
            <a href="#" class="cat-item" style="margin-top: 20px;">EVENTS</a>
        </aside>

        <main class="product-grid" id="grid">
            </main>
    </div>

    <footer>
        <p class="footer-text">© 2026 UNI.CIRCLE | ALL RIGHTS RESERVED</p>
        <p class="footer-text" id="status-text">NETWORK_STABLE</p>
    </footer>
</div>

<script>
lucide.createIcons();

// --- SUPABASE & RAZORPAY ---
const SB_URL = 'https://ydolglnquqkqiidiherk.supabase.co';
const SB_KEY = 'sb_publishable_WZOniquhPihxqDj8H9ndVQ_Uj9hAVOr';
const supabaseClient = supabase.createClient(SB_URL, SB_KEY);

async function load() {
    const { data, error } = await supabaseClient.from('listings').select('*').order('created_at', {ascending: false});
    const grid = document.getElementById('grid');
    if (data) {
        grid.innerHTML = data.map(item => `
            <div class="glass-card">
                <p style="font-size:0.4rem; color:var(--accent-green); font-family:var(--pixel-font); margin-bottom:10px;">[ ${item.category} ]</p>
                <h3 style="font-family:var(--pixel-font); font-size:0.6rem; letter-spacing:1px;">${item.title}</h3>
                <p style="font-size:0.7rem; color:#666; margin-top:10px; line-height:1.6;">${item.description}</p>
                <div class="price">₹${item.price}</div>
                <button class="node-btn" onclick="pay('${item.title}', ${item.price})">INITIALIZE_CHECKOUT</button>
            </div>
        `).join('');
    }
}

function pay(name, amt) {
    const options = {
        "key": "rzp_test_S39DY9dbDafQfC",
        "amount": amt * 100,
        "currency": "INR",
        "name": "UNI.CIRCLE",
        "description": "SECURE_BUY: " + name,
        "handler": function (res){ alert("TRANSACTION_COMPLETE: " + res.razorpay_payment_id); },
        "theme": { "color": "#00ff41" }
    };
    new Razorpay(options).open();
}

// --- CONSTELLATION BACKGROUND (From Home) ---
const bgCanvas = document.getElementById('bg-canvas');
const bgCtx = bgCanvas.getContext('2d');
bgCanvas.width = window.innerWidth; bgCanvas.height = window.innerHeight;
let pts = [];
for(let i=0; i<90; i++) pts.push({x:Math.random()*bgCanvas.width, y:Math.random()*bgCanvas.height, vx:(Math.random()-0.5)*0.3, vy:(Math.random()-0.5)*0.3});

function drawBg() {
    bgCtx.fillStyle = '#000'; bgCtx.fillRect(0,0,bgCanvas.width,bgCanvas.height);
    pts.forEach((p, i) => {
        p.x += p.vx; p.y += p.vy;
        if(p.x<0 || p.x>bgCanvas.width) p.vx*=-1; if(p.y<0 || p.y>bgCanvas.height) p.vy*=-1;
        bgCtx.fillStyle = 'rgba(255,255,255,0.7)';
        bgCtx.beginPath(); bgCtx.arc(p.x, p.y, 1.3, 0, Math.PI*2); bgCtx.fill();
        for(let j=i+1; j<pts.length; j++) {
            let d = Math.hypot(p.x-pts[j].x, p.y-pts[j].y);
            if(d < 180) {
                bgCtx.strokeStyle = `rgba(255,255,255,${0.25 - d/700})`;
                bgCtx.lineWidth = 0.9;
                bgCtx.beginPath(); bgCtx.moveTo(p.x, p.y); bgCtx.lineTo(pts[j].x, pts[j].y); bgCtx.stroke();
            }
        }
    });
    requestAnimationFrame(drawBg);
}

document.addEventListener('mousemove', (e) => {
    document.getElementById('custom-cursor').style.left = e.clientX + 'px';
    document.getElementById('custom-cursor').style.top = e.clientY + 'px';
});

window.onload = load;
drawBg();
</script>
</body>
</html>